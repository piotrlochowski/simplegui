<!doctype html>
<html lang="en" ng-app="myApp">
<head>
    <meta charset="utf-8">
    <title>Race Recorder</title>
    <link rel="stylesheet" href="css/app.css"/>
    <script>
        function GeneralEventCtrl($route, $scope, $http) {
            $scope.data = {refresh: false}
            var loadEventResults = function () {
                $http({method: 'GET', url: '/py/api/v1/event_driver'}).success(function (data) {
                    function sortByTimeN_1(a, b) {
                        return a.time_n - b.time_n
                    }

                    var results = data.event_drivers.sort(sortByTimeN_1).filter(function (result) {
                        if (result.time_n)
                            return result
                    });
                    $scope.results = results; // response data
                });
            }
            setInterval(function () {
                if ($scope.data.refresh === true && $route.current['loadedTemplateUrl'] === 'partials/partial0.html') {
                    loadEventResults()
                    console.log('Update generalki dla',$route.current['loadedTemplateUrl'])
                }
                ;
            }, 2000)
            loadEventResults()
        }

        function TrialDriverS1Ctrl($route, $scope, $http) {
            $scope.data = {refresh: false}
            var loadTrialDriverS1 = function () {
                $http({method: 'GET', url: '/py/api/v1/trial_driver/?trial=1'}).success(function (data) {
                    function sortByTimeN_1(a, b) {
                        return a.time_n - b.time_n
                    }

                    var results = data.trial_drivers.sort(sortByTimeN_1).filter(function (result) {
                        if (result.time_n)
                            return result
                    });
                    $scope.results = results; // response data
                });
            }
            setInterval(function () {
                if ($scope.data.refresh === true && $route.current['loadedTemplateUrl'] === 'partials/partial1.html') {
                    loadTrialDriverS1()
                    console.log('Update generalki dla',$route.current['loadedTemplateUrl'])
                }
                ;
            }, 2000)
            loadTrialDriverS1()
        }

        function TrialDriverS2Ctrl($route, $scope, $http) {
            $scope.data = {refresh: false}
            var loadTrialDriver21 = function () {
                $http({method: 'GET', url: '/py/api/v1/trial_driver/?trial=2'}).success(function (data) {
                function sortByTimeN_1(a, b) {
                    return a.time_n - b.time_n
                }

                var results = data.trial_drivers.sort(sortByTimeN_1).filter(function (result) {
                    if (result.time_n)
                        return result
                });
                $scope.results = results; // response data
            });}
            setInterval(function () {
                if ($scope.data.refresh === true && $route.current['loadedTemplateUrl'] === 'partials/partial2.html') {
                    loadTrialDriver21()
                    console.log('Update generalki dla',$route.current['loadedTemplateUrl'])
                }
                ;
            }, 2000)
            loadTrialDriver21()
        }
    </script>
</head>
<body>
<div id="wrap">
    <div id="top">
        <h2><a href="http://www.free-css.com/">Race Recorder - Wyrazów</a></h2>

        <div id="menu">
            <ul>
                <li><a href="#/generalka">Generalka</a></li>
                <li><a href="#/proba1">Próba 1</a></li>
                <li><a href="#/proba2">Próba 2</a></li>
            </ul>
        </div>
    </div>
    <div id="content">
        <label for="refresh">Automatyczne odświeżanie</label>

        <div ng-view></div>
    </div>
</div>

<!-- In production use:
<script src="//ajax.googleapis.com/ajax/libs/angularjs/1.0.7/angular.min.js"></script>
-->
<script src="lib/angular/angular.js"></script>
<script src="lib/angular/angular-route.js"></script>
<script src="js/app.js"></script>
<script src="js/services.js"></script>
<script src="js/controllers.js"></script>
<script src="js/filters.js"></script>
<script src="js/directives.js"></script>
</body>
</html>
